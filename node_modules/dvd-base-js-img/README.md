## Objects

<dl>
<dt><a href="#Img">Img</a> : <code>object</code></dt>
<dd></dd>
</dl>

## Functions

<dl>
<dt><a href="#init">init()</a> ⇒ <code>Promise</code></dt>
<dd><p>异步初始化Img，初始化完成后image属性会被赋值为已加载完图片的Image类型</p>
</dd>
<dt><a href="#load">load(url)</a> ⇒ <code>Promise</code></dt>
<dd><p>加载图片，加载后image属性才会有值</p>
</dd>
<dt><a href="#load">load(url)</a> ⇒ <code>Promise</code></dt>
<dd><p>加载图片，加载后image属性才会有值</p>
</dd>
<dt><a href="#turn">turn(isClockwise)</a></dt>
<dd><p>旋转图片，目前只支持90度旋转</p>
</dd>
<dt><a href="#clip">clip()</a></dt>
<dd><p>图片裁切</p>
</dd>
<dt><a href="#compress">compress(size, returnType)</a> ⇒ <code>base64</code> | <code>Promise</code></dt>
<dd><p>压缩图片</p>
</dd>
<dt><a href="#autoCompress">autoCompress(maxSize, returnType)</a> ⇒ <code>Promise</code></dt>
<dd><p>自动判断是否压缩图片</p>
</dd>
<dt><a href="#toFile">toFile()</a> ⇒ <code>Promise</code></dt>
<dd><p>将当前图片对象转化成File对象（注意：当遇到大文件时，该方法非常慢，所以尽量避免使用）</p>
</dd>
<dt><a href="#toBase64">toBase64()</a> ⇒ <code>Promise</code></dt>
<dd><p>将当前图片对象转化成File对象</p>
</dd>
</dl>

<a name="Img"></a>

## Img : <code>object</code>
**Kind**: global namespace  
**Author:** sunweiguang [源码地址](http://gitlab.rd.vyohui.com/FE-Base/dvd-base-js-img.git)  
**Example**  
```js
http://gitlab.rd.vyohui.com/FE-Service/npm-test.git
http://bravetime.davdian.com/npm-test/dvd-base-com-img-clip.html
```
<a name="init"></a>

## init() ⇒ <code>Promise</code>
异步初始化Img，初始化完成后image属性会被赋值为已加载完图片的Image类型

**Kind**: global function  
**Async**:   
<a name="load"></a>

## load(url) ⇒ <code>Promise</code>
加载图片，加载后image属性才会有值

**Kind**: global function  

| Param | Type |
| --- | --- |
| url | <code>String</code> | 

<a name="load"></a>

## load(url) ⇒ <code>Promise</code>
加载图片，加载后image属性才会有值

**Kind**: global function  

| Param | Type |
| --- | --- |
| url | <code>String</code> | 

<a name="turn"></a>

## turn(isClockwise)
旋转图片，目前只支持90度旋转

**Kind**: global function  

| Param | Description |
| --- | --- |
| isClockwise | 顺时针(true)、逆时针(false) |

<a name="clip"></a>

## clip()
图片裁切

**Kind**: global function  
**Example**  
```js
img.clip({
        x: 0, // 起始X坐标
        y: 0, // 起始Y坐标
        width: 0, // 切片宽度
        height: 0, // 切片高度
        returnType: 'base64', // 返回类型，base64字符串或者File对象。注意：当压缩图片后续操作是上传的话，returnType指定为'File'效率要高于'base64'
      });
```
<a name="compress"></a>

## compress(size, returnType) ⇒ <code>base64</code> &#124; <code>Promise</code>
压缩图片

**Kind**: global function  
**Returns**: <code>base64</code> &#124; <code>Promise</code> - 当returnType指定为'File'时，返回Promise。  
**Async**:   

| Param | Type | Description |
| --- | --- | --- |
| size | <code>Number</code> | 目标尺寸,单位B |
| returnType | <code>&#x27;base64&#x27;</code> &#124; <code>&#x27;File&#x27;</code> | 返回类型，base64字符串或者File对象。注意：当压缩图片后续操作是上传的话，returnType指定为'File'效率要高于'base64' |

<a name="autoCompress"></a>

## autoCompress(maxSize, returnType) ⇒ <code>Promise</code>
自动判断是否压缩图片

**Kind**: global function  
**Returns**: <code>Promise</code> - 当returnType指定为'File'时，返回Promise。  
**Async**:   

| Param | Type | Description |
| --- | --- | --- |
| maxSize | <code>Number</code> | 最大图片体积,单位B，超出这个值时自动压缩图片到这个值 |
| returnType | <code>&#x27;base64&#x27;</code> &#124; <code>&#x27;File&#x27;</code> | 返回类型，base64字符串或者File对象。注意：当压缩图片后续操作是上传的话，returnType指定为'File'效率要高于'base64' |

<a name="toFile"></a>

## toFile() ⇒ <code>Promise</code>
将当前图片对象转化成File对象（注意：当遇到大文件时，该方法非常慢，所以尽量避免使用）

**Kind**: global function  
**Async**:   
<a name="toBase64"></a>

## toBase64() ⇒ <code>Promise</code>
将当前图片对象转化成File对象

**Kind**: global function  
<a name="getImgExt"></a>

## .getImgExt(img) ⇒ <code>\*</code> &#124; <code>string</code>
获取图片转换成文件后的扩展名

**Kind**: static function  

| Param | Type |
| --- | --- |
| img | <code>String(url)</code> &#124; <code>File</code> &#124; <code>Image</code> &#124; <code>[Img](#Img)</code> | 

<a name="multiAutoCompress"></a>

## .multiAutoCompress(img, maxSize, returnType) ⇒ <code>\*</code> &#124; <code>string</code>
批量自动压缩图片

**Kind**: static function  
**Async**:   

| Param | Type | Description |
| --- | --- | --- |
| img | <code>String(url)</code> &#124; <code>File</code> &#124; <code>Image</code> &#124; <code>[Img](#Img)</code> |  |
| maxSize | <code>Number</code> | 最大图片体积,单位MB，超出这个值时自动压缩图片到这个值 |
| returnType | <code>&#x27;base64&#x27;</code> &#124; <code>&#x27;File&#x27;</code> | 返回类型，base64字符串或者File对象。注意：当压缩图片后续操作是上传的话，returnType指定为'File'效率要高于'base64' |

<a name="base64ToBlob"></a>

## .base64ToBlob(base64) ⇒ <code>Blob</code>
base64格式字符串转文件对象

**Kind**: static function  

| Param | Type | Description |
| --- | --- | --- |
| base64 | <code>String(base64)</code> | base64字符串 |

<a name="blobToFile"></a>

## .blobToFile(blob, fileName, fileType) ⇒ <code>File</code>
Blob对象转File对象

**Kind**: static function  

| Param | Type | Description |
| --- | --- | --- |
| blob | <code>Blob</code> |  |
| fileName | <code>String</code> | 文件名 |
| fileType | <code>String</code> | 文件类型 |

<a name="fileIsConstructor"></a>

## .fileIsConstructor() ⇒ <code>Boolean</code>
检测File类型是否是构造函数，ios8以下File不是构造函数

**Kind**: static function  
<a name="canvasToBlob"></a>

## .canvasToBlob(canvas, fileType) ⇒ <code>Promise</code>
将传入的canvas画布中图像导出为Blob。（目前只发现Android5.1及以下不支持canvas.toBlob，所以对canvas.toBlob做兼容性处理）

**Kind**: static function  

| Param | Type | Description |
| --- | --- | --- |
| canvas | <code>Canvas</code> | 即将被导出的canvas |
| fileType | <code>String</code> | 导出的数据类型，如png/jpeg |

<a name="canvasExport"></a>

## .canvasExport(canvas, dataType, imgType) ⇒ <code>Promise</code>
图片合成，将多张图片合成一张图片

**Kind**: static function  

| Param | Type | Description |
| --- | --- | --- |
| canvas | <code>Canvas</code> | 即将被导出的canvas |
| dataType | <code>String</code> | 导出的数据类型，取值范围（'base64'|'Blob'|'File'） |
| imgType | <code>String</code> | 导出的图片类型，取值范围（png|jpeg|jpg等） |

<a name="compound"></a>

## .compound(param) ⇒ <code>Promise</code>
图片合成功能，将多张图片、文字、二维码合成最重生成一张图片

**Kind**: static function  
**Async**:   

| Param | Type | Description |
| --- | --- | --- |
| param | <code>Object</code> | 复合参数 |
| param.ratio | <code>Number</code> | 实际生成的图片倍率，绘制过程中画布的大小和图片的x、y、width、height会和这个倍率相乘，可以根据实际需要设置为1、2、3等  背景：实际运用中我们经常根据设计稿设置x、y、width、height，但生成的图片在高倍屏下展示是不清晰的  举例：宽100px在2倍屏中以100px展示是不清晰的，此时需要将ratio设置为2生成200px宽度的图片以100px来展示，此时才是清晰的。 |
| param.canvas | <code>Object</code> | 画布属性 |
| param.canvas.width | <code>Number</code> | 画布宽度，也就是最后导出的图片宽度 |
| param.canvas.height | <code>Number</code> | 画布高度，也就是最后导出的图片高度 |
| param.returnType | <code>&#x27;base64&#x27;</code> &#124; <code>&#x27;Blob&#x27;</code> &#124; <code>&#x27;File&#x27;</code> | 返回的数据类型 {String} |
| param.items | <code>Array(Object)</code> | 图片对象数组，根据图片在数组中的位置顺序依次绘制图片，如果发生重叠，位置靠后的图片会覆盖位置靠前的图片 |
| param.items[i].type | <code>&#x27;img&#x27;</code> &#124; <code>&#x27;text&#x27;</code> &#124; <code>&#x27;qrcode&#x27;</code> | 可以设置图片、文本、二维码，根据type的不同取不同的属性 |
| param.items[type等于img].img | <code>String(url)</code> &#124; <code>File</code> &#124; <code>Blob</code> &#124; <code>Image</code> | 图片源，取值范围 |
| param.items[type等于img].x | <code>Number</code> &#124; <code>&#x27;%&#x27;</code> | 相对于画布原点的X坐标，取值范围：{数字|百分比}（数字代表px，百分比是相对于画布的宽度） |
| param.items[type等于img].y | <code>Number</code> &#124; <code>&#x27;%&#x27;</code> | 相对于画布原点的Y坐标，取值范围：{数字|百分比}（数字代表px，百分比是相对于画布的高度） |
| param.items[type等于img].width | <code>Number</code> &#124; <code>&#x27;%&#x27;</code> | 图片被绘制到画布中后的宽度，取值范围：{数字|百分比}（数字代表px，百分比是相对于画布的宽度）  如果不指定宽度或宽度设置为0则自动计算宽度(规则：如果指定了高度-则根据高度等比例缩放设置宽度，如果连高度都没有-则宽度等于原图片宽度) |
| param.items[type等于img].height | <code>Number</code> &#124; <code>&#x27;%&#x27;</code> | 图片被绘制到画布中后的高度，取值范围：{数字|百分比}（数字代表px，百分比是相对于画布的高度）  如果不指定高度或高度设置为0则自动计算高度(规则：如果指定了宽度-则根据宽度等比例缩放设置高度，如果连宽度都没有-则高度等于原图片高度) |
| param.items[type等于img].clip.x | <code>Number</code> | 相对于画布原点的X坐标 |
| param.items[type等于img].clip.y | <code>Number</code> | 相对于画布原点的Y坐标 |
| param.items[type等于img].clip.width | <code>Number</code> | 图片被绘制到画布中后的宽度 |
| param.items[type等于img].clip.height | <code>Number</code> | 图片被绘制到画布中后的高度 |
| param.items[type等于text].hollow | <code>Boolean</code> | 是否空心文字 |
| param.items[type等于text].x | <code>Boolean</code> | 相对于画布原点的X坐标，取值范围：{数字|百分比}（数字代表px，百分比是相对于画布的宽度） |
| param.items[type等于text].y | <code>Boolean</code> | 相对于画布原点的X坐标，取值范围：{数字|百分比}（数字代表px，百分比是相对于画布的高度） |
| param.items[type等于text].text | <code>String</code> | 文字内容 |
| param.items[type等于text].text | <code>String</code> | 文字颜色，取值范围和CSS color相同 |
| param.items[type等于text].fontSize | <code>Number</code> | 文字大小，单位px |
| param.items[type等于text].fontFamily | <code>String</code> | 文字字体 |
| param.items[type等于text].align | <code>&#x27;start&#x27;</code> &#124; <code>&#x27;end&#x27;</code> &#124; <code>&#x27;left&#x27;</code> &#124; <code>&#x27;right&#x27;</code> &#124; <code>&#x27;center&#x27;</code> | 文字对齐方式，对齐的起始点是x坐标，默认值left |
| param.items[type等于text].baseline | <code>&#x27;top&#x27;</code> &#124; <code>&#x27;hanging&#x27;</code> &#124; <code>&#x27;middle&#x27;</code> &#124; <code>&#x27;alphabetic&#x27;</code> &#124; <code>&#x27;ideographic&#x27;</code> &#124; <code>&#x27;bottom&#x27;</code> | 文字基线对齐方式，默认值alphabetic |
| param.items[type等于text].direction | <code>&#x27;ltr&#x27;</code> &#124; <code>&#x27;rtl&#x27;</code> | 文本方向，默认值ltr |
| param.items[type等于text].shadow | <code>Object</code> | 文字阴影Y |
| param.items[type等于text].shadow.x | <code>Number</code> | 文字阴影X偏移量，默认值0 |
| param.items[type等于text].shadow.y | <code>Number</code> | 文字阴影Y偏移量，默认值0 |
| param.items[type等于text].shadow.blur | <code>Number</code> | 文字阴影Y偏移量，默认值0 |
| param.items[type等于text].shadow.color | <code>String</code> | 文字阴影Y偏移量，默认值'black' |
| param.items[type等于qrcode].x | <code>Number</code> | 相对于画布原点的X坐标，取值范围：{数字|百分比}（数字代表px，百分比是相对于画布的宽度） |
| param.items[type等于qrcode].y | <code>Number</code> | 相对于画布原点的Y坐标，取值范围：{数字|百分比}（数字代表px，百分比是相对于画布的高度） |
| param.items[type等于qrcode].width | <code>Number</code> &#124; <code>&#x27;%&#x27;</code> | 图片被绘制到画布中后的宽度，取值范围：{数字|百分比}（数字代表px，百分比是相对于画布的宽度）  如果不指定宽度或宽度设置为0则自动计算宽度(规则：如果指定了高度-则根据高度等比例缩放设置宽度，如果连高度都没有-则宽度等于原图片宽度) |
| param.items[type等于qrcode].height | <code>Number</code> &#124; <code>&#x27;%&#x27;</code> | 图片被绘制到画布中后的高度，取值范围：{数字|百分比}（数字代表px，百分比是相对于画布的高度）  如果不指定高度或高度设置为0则自动计算高度(规则：如果指定了宽度-则根据宽度等比例缩放设置高度，如果连宽度都没有-则高度等于原图片高度) |
| param.items[type等于qrcode].clip.x | <code>Number</code> | 相对于画布原点的X坐标 |
| param.items[type等于qrcode].clip.y | <code>Number</code> | 相对于画布原点的Y坐标 |
| param.items[type等于qrcode].clip.width | <code>Number</code> | 图片被绘制到画布中后的宽度 |
| param.items[type等于qrcode].clip.height | <code>Number</code> | 图片被绘制到画布中后的高度 |
| param.items[type等于qrcode].options | <code>Object</code> | 符合参数，此处调用dvd-base-js-qrcode模块生成二维码，具体请参见dvd-base-js-qrcode模块文档 |

**Example**  
```js
演示项目地址，将来npm-test项目配置到charles本地启动看效果
 http://gitlab.rd.vyohui.com/FE-Service/npm-test.git
 http://18686604386.davdian.com/npm-test/dvd-base-js-img_compound.html
```
